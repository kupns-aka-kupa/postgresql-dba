# Homework #4

1. [Roles](#roles)
2. [WAL](#wal)

## <a name="roles"></a> Roles

1. Create database

```shell
sudo -u postgres psql  -c "create database hw4"
```

2. Create schema and table

```sql
create schema hw;
create table hw.authors
(
    id   int generated by default as identity,
    name text not null
);
insert into hw.authors(name)
values ('Rick Astley');
```

3. Create user, `read only` role and and grant usage

```sql
create role hw4_ro;
grant usage on schema hw to hw4_ro;
grant select on hw.authors to hw4_ro;
create user hw4 password 'hw4' in role hw4_ro;
```

4. Select by `hw4_ro`

```shell
psql -b hw4 -U hw4 -c "select * from hw.authors" 
```

| id  | name        |
|-----|-------------|
| 1   | Rick Astley |

5. Create `write only` role

```sql
create role hw4_wo;
grant create on schema hw to hw4_wo;
grant insert on hw.authors to hw4_wo;
grant hw4_wo to hw4;
```

6. Now we have access to insert some rows

```shell
psql -b hw4 -U hw4 -c "insert into hw.authors(name) values ('Smash Mouth');"
psql -b hw4 -U hw4 -c "select * from hw.authors" 
```

| id  | name        |
|-----|-------------|
| 1   | Rick Astley |
| 2   | Smash Mouth |

---

## <a name="wal"></a> WAL

1. Setup checkpoints timeout

- `postgressql.conf`

```shell
checkpoint_timeout = 30s   
```
